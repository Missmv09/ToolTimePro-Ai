(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[716],{2898:function(e,t,r){"use strict";r.d(t,{Z:function(){return createLucideIcon}});var a=r(2265),s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),createLucideIcon=(e,t)=>{let r=(0,a.forwardRef)(({color:r="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:o="",children:u,...c},d)=>(0,a.createElement)("svg",{ref:d,...s,width:n,height:n,stroke:r,strokeWidth:l?24*Number(i)/Number(n):i,className:["lucide",`lucide-${toKebabCase(e)}`,o].join(" "),...c},[...t.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(u)?u:[u]]));return r.displayName=`${e}`,r}},8291:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var a=r(2898);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a.Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},7216:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var a=r(2898);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a.Z)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},9670:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var a=r(2898);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a.Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},8083:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var a=r(2898);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a.Z)("HardHat",[["path",{d:"M2 18a1 1 0 0 0 1 1h18a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v2z",key:"1dej2m"}],["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6h0",key:"1uc279"}],["path",{d:"M14 6h0a6 6 0 0 1 6 6v3",key:"1j9mnm"}]])},5589:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var a=r(2898);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a.Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},1295:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var a=r(2898);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a.Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},2665:function(e,t,r){Promise.resolve().then(r.bind(r,2015))},2015:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return LoginPage}});var a=r(7437),s=r(2265),n=r(4033),i=r(1396),l=r.n(i),o=r(8083),u=r(1295),c=r(5589),d=r(7216),h=r(9670),m=r(8291),f=r(3549);function LoginPage(){let e=(0,n.useRouter)(),{signIn:t}=(0,f.useAuth)(),[r,i]=(0,s.useState)(""),[x,p]=(0,s.useState)(""),[y,g]=(0,s.useState)(!1),[v,w]=(0,s.useState)(!1),[b,j]=(0,s.useState)(""),handleSubmit=async a=>{a.preventDefault(),j(""),w(!0);let{error:s}=await t(r,x);if(s){j(s.message),w(!1);return}e.push("/dashboard")};return(0,a.jsxs)("div",{className:"min-h-screen bg-navy-gradient flex flex-col",children:[(0,a.jsx)("div",{className:"flex items-center justify-center pt-12 pb-8",children:(0,a.jsxs)(l(),{href:"/",className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gold-500 rounded-xl flex items-center justify-center",children:(0,a.jsx)(o.Z,{className:"w-7 h-7 text-navy-500"})}),(0,a.jsx)("span",{className:"text-2xl font-bold text-white",children:"ToolTime Pro"})]})}),(0,a.jsx)("div",{className:"flex-1 flex items-start justify-center px-4 pb-12",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-8 max-w-md w-full",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-navy-500 mb-2",children:"Welcome Back"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"Sign in to your account"}),(0,a.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"input-label",children:"Email Address"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(u.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,a.jsx)("input",{type:"email",value:r,onChange:e=>i(e.target.value),placeholder:"you@company.com",className:"input pl-10",required:!0})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsx)("label",{className:"input-label mb-0",children:"Password"}),(0,a.jsx)(l(),{href:"/auth/forgot-password",className:"text-sm text-gold-500 hover:text-gold-600",children:"Forgot password?"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(c.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,a.jsx)("input",{type:y?"text":"password",value:x,onChange:e=>p(e.target.value),placeholder:"Enter your password",className:"input pl-10 pr-10",required:!0}),(0,a.jsx)("button",{type:"button",onClick:()=>g(!y),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:y?(0,a.jsx)(d.Z,{size:20}):(0,a.jsx)(h.Z,{size:20})})]})]}),b&&(0,a.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:b}),(0,a.jsx)("button",{type:"submit",disabled:v,className:"btn-secondary w-full py-3 text-lg disabled:opacity-50 disabled:cursor-not-allowed",children:v?(0,a.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)("span",{className:"w-5 h-5 border-2 border-navy-500 border-t-transparent rounded-full animate-spin"}),"Signing In..."]}):(0,a.jsxs)("span",{className:"flex items-center justify-center gap-2",children:["Sign In",(0,a.jsx)(m.Z,{size:20})]})})]}),(0,a.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200 text-center",children:(0,a.jsxs)("p",{className:"text-gray-600",children:["Don't have an account?"," ",(0,a.jsx)(l(),{href:"/auth/signup",className:"font-semibold text-gold-500 hover:text-gold-600",children:"Start Free Trial"})]})}),(0,a.jsx)("div",{className:"mt-4 text-center",children:(0,a.jsx)(l(),{href:"/worker/login",className:"text-sm text-gray-500 hover:text-gray-700",children:"Worker? Login here with your PIN"})})]})})]})}},3549:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return AuthProvider},useAuth:function(){return useAuth}});var a=r(7437),s=r(2265),n=r(7823);let i=(0,s.createContext)(void 0);function AuthProvider(e){let{children:t}=e,[r,l]=(0,s.useState)(null),[o,u]=(0,s.useState)(null),[c,d]=(0,s.useState)(null),[h,m]=(0,s.useState)(null),[f,x]=(0,s.useState)(!0),fetchUserData=async e=>{try{let{data:t,error:r}=await n.OQ.from("users").select("*").eq("id",e).single();if(r&&"PGRST116"!==r.code){console.error("Error fetching user:",r);return}if(t&&(u(t),t.company_id)){let{data:e,error:r}=await n.OQ.from("companies").select("*").eq("id",t.company_id).single();r?console.error("Error fetching company:",r):d(e)}}catch(e){console.error("Error in fetchUserData:",e)}};(0,s.useEffect)(()=>{let initializeAuth=async()=>{try{var e;let{data:{session:t}}=await n.OQ.auth.getSession();m(t),l(null!==(e=null==t?void 0:t.user)&&void 0!==e?e:null),(null==t?void 0:t.user)&&await fetchUserData(t.user.id)}catch(e){console.error("Error initializing auth:",e)}finally{x(!1)}};initializeAuth();let{data:{subscription:e}}=n.OQ.auth.onAuthStateChange(async(e,t)=>{var r;m(t),l(null!==(r=null==t?void 0:t.user)&&void 0!==r?r:null),(null==t?void 0:t.user)?await fetchUserData(t.user.id):(u(null),d(null)),x(!1)});return()=>{e.unsubscribe()}},[]);let signUp=async(e,t,r,a)=>{try{let{data:s,error:i}=await n.OQ.auth.signUp({email:e,password:t,options:{data:{full_name:r}}});if(i)return{error:i};if(!s.user)return{error:Error("Failed to create user")};let{data:l,error:o}=await n.OQ.from("companies").insert({name:a,email:e}).select().single();if(o)return console.error("Error creating company:",o),{error:o};let{error:u}=await n.OQ.from("users").insert({id:s.user.id,email:e,full_name:r,company_id:l.id,role:"owner"});if(u)return console.error("Error creating user profile:",u),{error:u};return{error:null}}catch(e){return console.error("Signup error:",e),{error:e}}},signIn=async(e,t)=>{try{let{error:r}=await n.OQ.auth.signInWithPassword({email:e,password:t});if(r)return{error:r};return{error:null}}catch(e){return{error:e}}},signOut=async()=>{await n.OQ.auth.signOut(),l(null),u(null),d(null),m(null)},resetPassword=async e=>{try{let{error:t}=await n.OQ.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/auth/reset-password")});if(t)return{error:t};return{error:null}}catch(e){return{error:e}}};return(0,a.jsx)(i.Provider,{value:{user:r,dbUser:o,company:c,session:h,isLoading:f,signUp,signIn,signOut,resetPassword},children:t})}function useAuth(){let e=(0,s.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},7823:function(e,t,r){"use strict";r.d(t,{OQ:function(){return i}});var a=r(9073);let s="https://bqcymeefaizydfogaxcp.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxY3ltZWVmYWl6eWRmb2dheGNwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg4Nzg0MjQsImV4cCI6MjA4NDQ1NDQyNH0.cTHXYffDL2DSePpTOCJIETtwlt8R1qJesyFs_5I3808";if(!s||!n)throw Error("Missing Supabase environment variables");let i=(0,a.eI)(s,n)},1396:function(e,t,r){e.exports=r(8326)},4033:function(e,t,r){e.exports=r(94)}},function(e){e.O(0,[326,311,971,472,744],function(){return e(e.s=2665)}),_N_E=e.O()}]);