(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{2898:function(e,t,s){"use strict";s.d(t,{Z:function(){return createLucideIcon}});var a=s(2265),r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),createLucideIcon=(e,t)=>{let s=(0,a.forwardRef)(({color:s="currentColor",size:n=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:c="",children:d,...o},u)=>(0,a.createElement)("svg",{ref:u,...r,width:n,height:n,stroke:s,strokeWidth:i?24*Number(l)/Number(n):l,className:["lucide",`lucide-${toKebabCase(e)}`,c].join(" "),...o},[...t.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(d)?d:[d]]));return s.displayName=`${e}`,s}},1981:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(2898);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},8203:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(2898);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},7619:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(2898);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]])},6141:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(2898);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},1298:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(2898);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},6637:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(2898);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},1295:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(2898);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},6142:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(2898);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},2741:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(2898);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},4280:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(2898);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},7972:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(2898);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},5750:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(2898);/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},3274:function(e,t,s){Promise.resolve().then(s.bind(s,813))},813:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return DashboardPage}});var a=s(7437),r=s(2265),n=s(1396),l=s.n(n),i=s(1981),c=s(7619),d=s(5750),o=s(6141),u=s(1298),h=s(4280),m=s(8203),x=s(6142),g=s(2741),f=s(1295),v=s(6637),y=s(7972),b=s(7823),p=s(3549);function useDashboard(){let{company:e}=(0,p.useAuth)(),[t,s]=(0,r.useState)(null),[a,n]=(0,r.useState)(!0),[l,i]=(0,r.useState)(null),c=(0,r.useCallback)(async()=>{if(null==e?void 0:e.id){n(!0),i(null);try{var t;let a=new Date().toISOString().split("T")[0],r=new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],[n,l,i,c,d,o,u]=await Promise.all([b.OQ.from("jobs").select("id",{count:"exact",head:!0}).eq("company_id",e.id).eq("scheduled_date",a),b.OQ.from("leads").select("id",{count:"exact",head:!0}).eq("company_id",e.id).eq("status","new"),b.OQ.from("time_entries").select("id",{count:"exact",head:!0}).eq("company_id",e.id).gte("clock_in","".concat(a,"T00:00:00")).is("clock_out",null),b.OQ.from("invoices").select("total").eq("company_id",e.id).eq("status","paid").gte("paid_at",r),b.OQ.from("jobs").select("\n            id,\n            title,\n            scheduled_time_start,\n            scheduled_time_end,\n            status,\n            address,\n            customer:customers(name),\n            assignments:job_assignments(\n              user:users(full_name)\n            )\n          ").eq("company_id",e.id).eq("scheduled_date",a).order("scheduled_time_start",{ascending:!0}).limit(10),b.OQ.from("leads").select("id, name, phone, email, service_requested, source, status, created_at").eq("company_id",e.id).order("created_at",{ascending:!1}).limit(5),b.OQ.from("time_entries").select("\n            id,\n            clock_in,\n            user:users(id, full_name),\n            job:jobs(id, title)\n          ").eq("company_id",e.id).gte("clock_in","".concat(a,"T00:00:00")).is("clock_out",null)]),h=(null===(t=c.data)||void 0===t?void 0:t.reduce((e,t)=>e+(t.total||0),0))||0;s({stats:{todaysJobs:n.count||0,newLeads:l.count||0,workersOnClock:i.count||0,monthlyRevenue:h},todaysJobs:d.data||[],recentLeads:o.data||[],clockedInWorkers:u.data||[]})}catch(e){console.error("Error fetching dashboard data:",e),i("Failed to load dashboard data")}finally{n(!1)}}},[null==e?void 0:e.id]);return(0,r.useEffect)(()=>{c()},[c]),(0,r.useEffect)(()=>{if(!(null==e?void 0:e.id))return;let t=b.OQ.channel("leads-changes").on("postgres_changes",{event:"INSERT",schema:"public",table:"leads",filter:"company_id=eq.".concat(e.id)},()=>{c()}).subscribe(),s=b.OQ.channel("time-entries-changes").on("postgres_changes",{event:"*",schema:"public",table:"time_entries",filter:"company_id=eq.".concat(e.id)},()=>{c()}).subscribe();return()=>{b.OQ.removeChannel(t),b.OQ.removeChannel(s)}},[null==e?void 0:e.id,c]),{data:t,isLoading:a,error:l,refetch:c}}let j={scheduled:"badge-info",in_progress:"badge-warning",completed:"badge-success",cancelled:"badge-danger"},N={new:"badge-gold",contacted:"badge-info",quoted:"badge-warning",won:"badge-success",lost:"badge-danger"};function formatTime(e){if(!e)return"-";let[t,s]=e.split(":"),a=parseInt(t);return"".concat(a%12||12,":").concat(s," ").concat(a>=12?"PM":"AM")}function formatCurrency(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}function formatDateTime(e){let t=new Date(e);return t.toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}function getTimeSince(e){let t=new Date(e),s=new Date,a=s.getTime()-t.getTime(),r=Math.floor(a/6e4),n=Math.floor(r/60);return r<60?"".concat(r,"m ago"):"".concat(n,"h ").concat(r%60,"m")}function getCustomerName(e){var t;return e?Array.isArray(e)?(null===(t=e[0])||void 0===t?void 0:t.name)||"-":e.name||"-":"-"}function getWorkerNames(e){return e&&0!==e.length&&e.map(e=>{var t;return e.user?Array.isArray(e.user)?null===(t=e.user[0])||void 0===t?void 0:t.full_name:e.user.full_name:null}).filter(Boolean).join(", ")||"-"}function DashboardPage(){var e;let{dbUser:t,company:s}=(0,p.useAuth)(),{data:n,isLoading:b,error:w,refetch:k}=useDashboard(),[_,Z]=(0,r.useState)(!1),handleRefresh=async()=>{Z(!0),await k(),Z(!1)};if(b)return(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"h-8 w-48 bg-gray-200 rounded animate-pulse"}),(0,a.jsx)("div",{className:"h-5 w-64 bg-gray-200 rounded animate-pulse mt-2"})]})}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(e=>(0,a.jsx)("div",{className:"card h-32 animate-pulse bg-gray-100"},e))}),(0,a.jsx)("div",{className:"card h-64 animate-pulse bg-gray-100"})]});if(w)return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,a.jsx)(i.Z,{className:"w-12 h-12 text-red-500 mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-navy-500 mb-2",children:"Error Loading Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:w}),(0,a.jsx)("button",{onClick:handleRefresh,className:"btn-primary",children:"Try Again"})]});let C=[{label:"Today's Jobs",value:(null==n?void 0:n.stats.todaysJobs.toString())||"0",icon:c.Z,color:"bg-blue-50",iconColor:"text-blue-500"},{label:"New Leads",value:(null==n?void 0:n.stats.newLeads.toString())||"0",icon:d.Z,color:"bg-gold-50",iconColor:"text-gold-500"},{label:"Workers Clocked In",value:(null==n?void 0:n.stats.workersOnClock.toString())||"0",icon:o.Z,color:"bg-green-50",iconColor:"text-green-500"},{label:"Revenue This Month",value:formatCurrency((null==n?void 0:n.stats.monthlyRevenue)||0),icon:u.Z,color:"bg-purple-50",iconColor:"text-purple-500"}];return(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-navy-500",children:"Dashboard"}),(0,a.jsxs)("p",{className:"text-gray-500 mt-1",children:["Welcome back, ",(null==t?void 0:null===(e=t.full_name)||void 0===e?void 0:e.split(" ")[0])||"there","! Here's what's happening today."]})]}),(0,a.jsxs)("button",{onClick:handleRefresh,disabled:_,className:"btn-ghost flex items-center gap-2",children:[(0,a.jsx)(h.Z,{className:"w-4 h-4 ".concat(_?"animate-spin":"")}),"Refresh"]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:C.map(e=>(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsx)("div",{className:"w-12 h-12 ".concat(e.color," rounded-lg flex items-center justify-center"),children:(0,a.jsx)(e.icon,{className:"w-6 h-6 ".concat(e.iconColor)})})}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("p",{className:"stat-value",children:e.value}),(0,a.jsx)("p",{className:"stat-label",children:e.label})]})]},e.label))}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(m.Z,{className:"w-5 h-5 text-navy-500"}),(0,a.jsx)("h2",{className:"text-lg font-semibold text-navy-500",children:"Today's Schedule"})]}),(0,a.jsx)(l(),{href:"/dashboard/jobs",className:"btn-ghost text-sm",children:"View All Jobs"})]}),(null==n?void 0:n.todaysJobs)&&n.todaysJobs.length>0?(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,a.jsx)("th",{className:"table-header",children:"Time"}),(0,a.jsx)("th",{className:"table-header",children:"Job"}),(0,a.jsx)("th",{className:"table-header",children:"Customer"}),(0,a.jsx)("th",{className:"table-header hidden md:table-cell",children:"Address"}),(0,a.jsx)("th",{className:"table-header hidden lg:table-cell",children:"Assigned To"}),(0,a.jsx)("th",{className:"table-header",children:"Status"})]})}),(0,a.jsx)("tbody",{children:n.todaysJobs.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50 cursor-pointer",children:[(0,a.jsxs)("td",{className:"table-cell whitespace-nowrap",children:[formatTime(e.scheduled_time_start),e.scheduled_time_end&&" - ".concat(formatTime(e.scheduled_time_end))]}),(0,a.jsx)("td",{className:"table-cell font-medium",children:e.title}),(0,a.jsx)("td",{className:"table-cell",children:getCustomerName(e.customer)}),(0,a.jsx)("td",{className:"table-cell hidden md:table-cell text-gray-500",children:e.address?(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(x.Z,{className:"w-3 h-3"}),e.address.substring(0,30),"..."]}):"-"}),(0,a.jsx)("td",{className:"table-cell hidden lg:table-cell",children:getWorkerNames(e.assignments)}),(0,a.jsx)("td",{className:"table-cell",children:(0,a.jsx)("span",{className:j[e.status]||"badge-info",children:e.status.replace("_"," ")})})]},e.id))})]})}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(c.Z,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No jobs scheduled for today"}),(0,a.jsx)(l(),{href:"/dashboard/jobs",className:"btn-secondary mt-4 inline-block",children:"Schedule a Job"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(d.Z,{className:"w-5 h-5 text-gold-500"}),(0,a.jsx)("h2",{className:"text-lg font-semibold text-navy-500",children:"Recent Leads"})]}),(0,a.jsx)(l(),{href:"/dashboard/leads",className:"btn-ghost text-sm",children:"View All"})]}),(null==n?void 0:n.recentLeads)&&n.recentLeads.length>0?(0,a.jsx)("div",{className:"space-y-4",children:n.recentLeads.map(e=>(0,a.jsxs)("div",{className:"flex items-start justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"font-medium text-navy-500 truncate",children:e.name}),(0,a.jsx)("span",{className:N[e.status]||"badge-info",children:e.status})]}),(0,a.jsx)("p",{className:"text-sm text-gray-500 truncate",children:e.service_requested||"No service specified"}),(0,a.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:[e.source," • ",formatDateTime(e.created_at)]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[e.phone&&(0,a.jsx)("a",{href:"tel:".concat(e.phone),className:"p-2 text-gray-400 hover:text-green-500 hover:bg-green-50 rounded-lg transition-colors",title:"Call",children:(0,a.jsx)(g.Z,{className:"w-4 h-4"})}),e.email&&(0,a.jsx)("a",{href:"mailto:".concat(e.email),className:"p-2 text-gray-400 hover:text-blue-500 hover:bg-blue-50 rounded-lg transition-colors",title:"Email",children:(0,a.jsx)(f.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{className:"p-2 text-gray-400 hover:text-gold-500 hover:bg-gold-50 rounded-lg transition-colors",title:"Create Quote",children:(0,a.jsx)(v.Z,{className:"w-4 h-4"})})]})]},e.id))}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(d.Z,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No leads yet"}),(0,a.jsx)(l(),{href:"/dashboard/leads",className:"btn-secondary mt-4 inline-block",children:"Add a Lead"})]})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(o.Z,{className:"w-5 h-5 text-green-500"}),(0,a.jsx)("h2",{className:"text-lg font-semibold text-navy-500",children:"Workers On Clock"})]}),(0,a.jsx)(l(),{href:"/dashboard/time-logs",className:"btn-ghost text-sm",children:"View Time Logs"})]}),(null==n?void 0:n.clockedInWorkers)&&n.clockedInWorkers.length>0?(0,a.jsx)("div",{className:"space-y-3",children:n.clockedInWorkers.map(e=>{var t;return(0,a.jsxs)("div",{className:"flex items-center gap-4 p-3 bg-green-50 border border-green-100 rounded-lg",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center",children:(0,a.jsx)(y.Z,{className:"w-5 h-5 text-white"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"font-medium text-navy-500",children:(null===(t=e.user)||void 0===t?void 0:t.full_name)||"Unknown Worker"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Clocked in ",getTimeSince(e.clock_in),e.job&&(0,a.jsxs)("span",{className:"text-green-600",children:[" • ",e.job.title]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 text-green-600",children:[(0,a.jsx)("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Active"})]})]},e.id)})}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(o.Z,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No workers clocked in"}),(0,a.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"Workers clock in via the mobile app"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsx)(l(),{href:"/dashboard/jobs",className:"card-hover cursor-pointer hover-lift",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-navy-500 rounded-lg flex items-center justify-center",children:(0,a.jsx)(c.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-navy-500",children:"Create New Job"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Schedule a new service"})]})]})}),(0,a.jsx)(l(),{href:"/dashboard/leads",className:"card-hover cursor-pointer hover-lift",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gold-500 rounded-lg flex items-center justify-center",children:(0,a.jsx)(d.Z,{className:"w-6 h-6 text-navy-500"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-navy-500",children:"Add New Lead"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Capture a potential customer"})]})]})}),(0,a.jsx)(l(),{href:"/dashboard/time-logs",className:"card-hover cursor-pointer hover-lift",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-green-500 rounded-lg flex items-center justify-center",children:(0,a.jsx)(o.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-navy-500",children:"View Time Logs"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Review worker hours"})]})]})})]})]})}},3549:function(e,t,s){"use strict";s.r(t),s.d(t,{AuthProvider:function(){return AuthProvider},useAuth:function(){return useAuth}});var a=s(7437),r=s(2265),n=s(7823);let l=(0,r.createContext)(void 0);function AuthProvider(e){let{children:t}=e,[s,i]=(0,r.useState)(null),[c,d]=(0,r.useState)(null),[o,u]=(0,r.useState)(null),[h,m]=(0,r.useState)(null),[x,g]=(0,r.useState)(!0),fetchUserData=async e=>{try{let{data:t,error:s}=await n.OQ.from("users").select("*").eq("id",e).single();if(s&&"PGRST116"!==s.code){console.error("Error fetching user:",s);return}if(t&&(d(t),t.company_id)){let{data:e,error:s}=await n.OQ.from("companies").select("*").eq("id",t.company_id).single();s?console.error("Error fetching company:",s):u(e)}}catch(e){console.error("Error in fetchUserData:",e)}};(0,r.useEffect)(()=>{let initializeAuth=async()=>{try{var e;let{data:{session:t}}=await n.OQ.auth.getSession();m(t),i(null!==(e=null==t?void 0:t.user)&&void 0!==e?e:null),(null==t?void 0:t.user)&&await fetchUserData(t.user.id)}catch(e){console.error("Error initializing auth:",e)}finally{g(!1)}};initializeAuth();let{data:{subscription:e}}=n.OQ.auth.onAuthStateChange(async(e,t)=>{var s;m(t),i(null!==(s=null==t?void 0:t.user)&&void 0!==s?s:null),(null==t?void 0:t.user)?await fetchUserData(t.user.id):(d(null),u(null)),g(!1)});return()=>{e.unsubscribe()}},[]);let signUp=async(e,t,s,a)=>{try{let{data:r,error:l}=await n.OQ.auth.signUp({email:e,password:t,options:{data:{full_name:s}}});if(l)return{error:l};if(!r.user)return{error:Error("Failed to create user")};let{data:i,error:c}=await n.OQ.from("companies").insert({name:a,email:e}).select().single();if(c)return console.error("Error creating company:",c),{error:c};let{error:d}=await n.OQ.from("users").insert({id:r.user.id,email:e,full_name:s,company_id:i.id,role:"owner"});if(d)return console.error("Error creating user profile:",d),{error:d};return{error:null}}catch(e){return console.error("Signup error:",e),{error:e}}},signIn=async(e,t)=>{try{let{error:s}=await n.OQ.auth.signInWithPassword({email:e,password:t});if(s)return{error:s};return{error:null}}catch(e){return{error:e}}},signOut=async()=>{await n.OQ.auth.signOut(),i(null),d(null),u(null),m(null)},resetPassword=async e=>{try{let{error:t}=await n.OQ.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/auth/reset-password")});if(t)return{error:t};return{error:null}}catch(e){return{error:e}}};return(0,a.jsx)(l.Provider,{value:{user:s,dbUser:c,company:o,session:h,isLoading:x,signUp,signIn,signOut,resetPassword},children:t})}function useAuth(){let e=(0,r.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},7823:function(e,t,s){"use strict";s.d(t,{OQ:function(){return c}});var a=s(9073),r=s(2601);let n=r.env.NEXT_PUBLIC_SUPABASE_URL||"",l=r.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"",i=null,c=i||(n&&l||console.warn("Supabase environment variables not configured"),i=(0,a.eI)(n||"https://placeholder.supabase.co",l||"placeholder"))}},function(e){e.O(0,[176,978,971,472,744],function(){return e(e.s=3274)}),_N_E=e.O()}]);